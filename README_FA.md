
# Automated Call Monitoring Script

این پروژه یک اسکریپت پایتون برای نظارت بر تماس‌های تلفنی و شناسایی فعالیت‌های کاربر است. این اسکریپت از کتابخانه‌هایی مانند `pyautogui`, `pygame`, `PaddleOCR` و `pandas` استفاده می‌کند. با استفاده از این اسکریپت، می‌توانید به طور خودکار تماس‌های تلفنی را برقرار کرده و اطلاعات کلیک کاربر را ثبت کنید.

## جدول محتوا
- [پیش‌نیازها](#پیش‌نیازها)
- [نصب](#نصب)
- [استفاده](#استفاده)
- [فایل‌های مورد نیاز](#فایل‌های-مورد-نیاز)
- [توابع کلیدی](#توابع-کلیدی)
- [نکات](#نکات)
- [مشارکت](#مشارکت)
- [لایسنس](#لایسنس)
- [تماس](#تماس)

## پیش‌نیازها

قبل از اجرای اسکریپت، موارد زیر را نصب کنید:

1. **VAC**:
   - می‌توانید VAC را از [اینجا](https://vac.muzychenko.net/en/download.htm) دانلود کنید.

2. **Visual C++ Redistributable**:
   - نسخه x64 را از [اینجا](https://support.microsoft.com/en-us/help/2977003/the-latest-supported-visual-c-downloads) دانلود و نصب کنید.

3. **کتابخانه‌های پایتون**:
   - از ترمینال دستور زیر را اجرا کنید:
     ```bash
     pip install -r requirements.txt
     ```

## نصب

1. **دانلود کد**: این پروژه را از گیت‌هاب Clone کنید:
   ```bash
   git clone https://github.com/Alireza-ME/VoipCaller.git
   cd VoipCaller
   ```

2. **اجرا**: اسکریپت را با استفاده از Python اجرا کنید:
   ```bash
   python main.py
   ```

## استفاده

1. **تنظیمات اولیه**:
   - پس از اجرای اسکریپت، از شما خواسته می‌شود که ناحیه‌ای را که می‌خواهید نظارت کنید و دکمه پایان تماس را مشخص کنید.
   
2. **عملکرد اسکریپت**:
   - شماره تماس‌هایی که در فایل `phones.xlsx` موجود است، پردازش می‌شود.
   - در صورت شناسایی کلیک کاربر، اطلاعات تماس و زمان ثبت می‌شود.
   - این اسکریپت با استفاده از OCR وضعیت تماس‌ها را بررسی کرده و فعالیت‌های کاربر را شناسایی می‌کند.
   - پس از برقراری تماس، صدای مشخصی پخش می‌شود.

## فایل‌های مورد نیاز

- **`phones.xlsx`**: فایلی که شامل شماره‌های تلفن است.
- **`voices/counsel.wav`**: فایل صوتی که در زمان برقراری تماس پخش می‌شود.

## توابع کلیدی

- `save_user_click_info(phone_number)`: اطلاعات کلیک کاربر را در فایل Excel ذخیره می‌کند.
  
- `get_region()`: ناحیه‌ای که می‌خواهید نظارت کنید را شناسایی می‌کند.
  
- `get_end_call_button_position()`: مختصات دکمه پایان تماس را شناسایی می‌کند.
  
- `monitor_call(region)`: تماس‌ها را نظارت کرده و وضعیت آنها را شناسایی می‌کند.
  
- `play_sound()`: صدای مشخصی را پخش می‌کند.
  
- `read_excel(file_path)`: فایل Excel را می‌خواند و اطلاعات موجود را برمی‌گرداند.
  
- `process_numbers(file_path)`: شماره‌های موجود در فایل Excel را پردازش می‌کند.
  
- `listen_for_keypresses(end_call_button_position, region, phone_number)`: صداها را گوش کرده و به فعالیت‌های کاربر پاسخ می‌دهد.

## نکات

- پیشنهاد می کنم از برنامه MicroSip استفاده کنید چون از dtmf پشتیبانی می کند
- مطمئن شوید که مجوزهای لازم برای دسترسی به صدا و انجام کلیک‌های خودکار را دارید.
- استفاده از این اسکریپت در محیط‌های تجاری یا عمومی ممکن است با قوانین محلی تضاد داشته باشد. از آن با احتیاط استفاده کنید.
- زمان‌بندی‌های موجود در اسکریپت (مانند زمان انتظار برای پخش صدا) را بر اساس نیاز خود تنظیم کنید.

## مشارکت

اگر تمایل به مشارکت در این پروژه دارید، می‌توانید به سادگی Fork کنید و درخواست Pull ارسال نمایید. همچنین می‌توانید مشکلات یا پیشنهادات خود را در بخش Issues مطرح کنید.

## لایسنس

این پروژه تحت لایسنس [MIT](LICENSE) منتشر شده است. برای اطلاعات بیشتر در مورد حقوق و مسئولیت‌های خود، به فایل لایسنس مراجعه کنید.

## تماس

اگر سوالی دارید یا نیاز به کمک بیشتری دارید، می‌توانید با من تماس بگیرید:
- ایمیل: your_email@example.com
- تلگرام: [A_Lireza_ME](https://t.me/A_Lireza_ME)
